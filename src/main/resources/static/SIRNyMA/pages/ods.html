<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Productos Relacionados con ODS</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
    <link rel="stylesheet" href="../styles/ods.css">
    <style>
       body, html {
            font-family: Helvetica, Sans-Serif !important;
            background-color: #f8f9fa;
        }
    </style>
</head>

<body>
      <!-- Navbar -->
      <nav class="navbar navbar-expand-lg navbar-dark" style="background-color: #003057;">
        <div class="container-fluid">
          <a class="navbar-brand" href="index.html">
            <img src="/assets/INEGI_g.png" alt="Logo INEGI" style="width: 9rem; filter: invert(1) brightness(2) contrast(1.5);">
          </a>
      
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
            <span class="navbar-toggler-icon"></span>
          </button>
      
          <div class="collapse navbar-collapse justify-content-between" id="navbarNav">
            <ul class="navbar-nav mx-auto gap-3">
              <li class="nav-item">
                <a class="nav-link" href="index.html">Inicio</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="procesos.html">Procesos</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="variables.html">Variables</a>
              </li>
              <li class="nav-item">
                <a class="nav-link active fw-bold text-decoration-underline" aria-current="page" href="ods.html">ODS</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="indicadores.html">Indicadores existentes</a>
              </li>
            </ul>
          </div>
        </div>
      </nav>
      
      <div class="container mt-5 mb-5">
        <h2 class="text-center mb-5">Objetivos del Desarrollo Sostenible</h2>
      
        <!-- Grid de objetivos ODS -->

    <!-- Objetivos del 1 al 6 -->

        <div class="row row-cols-2 row-cols-md-4 row-cols-lg-6 g-3 justify-content-center">
          <!-- Objetivos renderizados -->
          <!-- Puedes repetir este bloque con diferentes IDs e imágenes -->
          <div class="col text-center" id="Objetivo01">
            <img
              src="/assets/ODS0010_es.jpg"
              class="img-fluid rounded shadow-sm hover-animate"
              style="cursor: pointer; max-width: 160px"
              data-bs-toggle="collapse"
              data-bs-target="#collapseExample"
              aria-expanded="false"
              aria-controls="collapseExample"
              data-group="1_6"
              data-ods="1"
            >            
           <div class="result-container mt-2" id="result-Objetivo1"></div>
            <div class="text-center mt-2">
              <strong>Total de Variables ODS 1: 
                <span id="contador-ods-1" class="text-primary" 
                  style="text-decoration: underline; font-size: 1.1rem; font-family: Monaco, monospace;">
                  0
                </span>
              </strong>
            </div>
          </div>

                <div class="col-2" id="Objetivo02">
                  <div class="text-center">
                    <img class="img-fluid rounded shadow-sm hover-animate" src="/assets/ODS0020_es.jpg" style="max-width: 160px;" type="button"
                      data-bs-toggle="collapse" data-bs-target="#collapseExample2" aria-expanded="false"
                      aria-controls="collapseExample" data-ods="2" data-group="1_6">
                  </div>
                  <div class="result-container mt-2" id="result-Objetivo2"></div>
                  <div class="text-center mt-2">
                    <strong>Total de Variables ODS 2: 
                      <span id="contador-ods-2" class="text-primary" 
                        style="text-decoration: underline; font-size: 1.1rem; font-family: Monaco, monospace;">
                        0
                      </span>
                    </strong>
                  </div>
                </div>
          
                <div class="col-2" id="Objetivo03">
                  <div class="text-center">
                    <img class="img-fluid rounded shadow-sm hover-animate" src="/assets/ODS0030_es.jpg" style="max-width: 160px;" type="button"
                      data-bs-toggle="collapse" data-bs-target="#collapseExample3" aria-expanded="false"
                      aria-controls="collapseExample" data-ods="3" data-group="1_6">
                  </div>
                  <div class="result-container mt-2" id="result-Objetivo3"></div>
                  <div class="text-center mt-2">
                    <strong>Total de Variables ODS 3: 
                      <span id="contador-ods-3" class="text-primary" 
                        style="text-decoration: underline; font-size: 1.1rem; font-family: Monaco, monospace;">
                        0
                      </span>
                    </strong>
                  </div>
                </div>
          
                <div class="col-2" id="Objetivo04">
                  <div class="text-center">
                    <img class="img-fluid rounded shadow-sm hover-animate" src="/assets/ODS0040_es.jpg" style="max-width: 160px;" type="button"
                      data-bs-toggle="collapse" data-bs-target="#collapseExample4" aria-expanded="false"
                      aria-controls="collapseExample" data-ods="4" data-group="1_6">
                  </div>
                  <div class="result-container mt-2" id="result-Objetivo4"></div>
                  <div class="text-center mt-2">
                    <strong>Total de Variables ODS 4: 
                      <span id="contador-ods-4" class="text-primary" 
                        style="text-decoration: underline; font-size: 1.1rem; font-family: Monaco, monospace;">
                        0
                      </span>
                    </strong>
                  </div>
                </div>
          
                <div class="col-2" id="Objetivo05">
                  <div class="text-center">
                    <img class="img-fluid rounded shadow-sm hover-animate" src="/assets/ODS0050_es.jpg" style="max-width: 160px;" type="button"
                      data-bs-toggle="collapse" data-bs-target="#collapseExample5" aria-expanded="false"
                      aria-controls="collapseExample" data-ods="5" data-group="1_6">
                  </div>
                  <div class="result-container mt-2" id="result-Objetivo5"></div>
                  <div class="text-center mt-2">
                    <strong>Total de Variables ODS 5: 
                      <span id="contador-ods-5" class="text-primary" 
                        style="text-decoration: underline; font-size: 1.1rem; font-family: Monaco, monospace;">
                        0
                      </span>
                    </strong>
                  </div>
                </div>
          
                <div class="col-2" id="Objetivo06">
                  <div class="text-center">
                    <img class="img-fluid rounded shadow-sm hover-animate" src="/assets/ODS0060_es.jpg" style="max-width: 160px;" type="button"
                      data-bs-toggle="collapse" data-bs-target="#collapseExample6" aria-expanded="false"
                      aria-controls="collapseExample" data-ods="6" data-group="1_6">
                  </div>
                  <div class="result-container mt-2" id="result-Objetivo6"></div>
                  <div class="text-center mt-2">
                    <strong>Total de Variables ODS 6: 
                      <span id="contador-ods-6" class="text-primary" 
                        style="text-decoration: underline; font-size: 1.1rem; font-family: Monaco, monospace;">
                        0
                      </span>
                    </strong>
                  </div>
                </div>
          
                <div class="col-lados-custom"></div>

              </div>

              <!-- Contenedor dinámico para ODS 1 al 6 -->
            <div class="container mt-4 d-none" id="contenedorGrupo1_6">
              <div class="card shadow-sm border-0">
                <div class="card-body">
                  <div class="d-flex justify-content-end align-items-center mb-3">
                    <label for="itemsPerPage1" class="me-2 mb-0">Mostrar:</label>
                    <select id="itemsPerPage1" class="form-select w-auto">
                      <option value="10">10</option>
                      <option value="20">20</option>
                    </select>
                  </div>
                  <div id="chartArea1_6" class="d-flex justify-content-center my-4"></div>
                  <div id="OdsContainer1_6"></div>
                  <nav>
                    <ul class="pagination justify-content-center mt-4" id="pagination1_6"></ul>
                  </nav>
                </div>
              </div>
            </div>

<!-- Objetivos del 7 al 12 -->
              <div class="row g-1 m-0">
                
                <div class="col-2" id="Objetivo7">
                  <div class="text-center">
                    <img class="img-fluid rounded shadow-sm hover-animate" src="/assets/ODS0070_es.jpg" style="max-width: 160px;" type="button"
                      data-bs-toggle="collapse" data-bs-target="#collapseExample7" aria-expanded="false"
                      aria-controls="collapseExample" data-ods="7" data-group="7_12">
                  </div>
                  <div class="result-container mt-2" id="result-Objetivo7"></div>
                  <div class="text-center mt-2">
                    <strong>Total de Variables ODS 7: 
                      <span id="contador-ods-7" class="text-primary" 
                        style="text-decoration: underline; font-size: 1.1rem; font-family: Monaco, monospace;">
                        0
                      </span>
                    </strong>
                  </div>
                </div>
          
                <div class="col-2" id="Objetivo8">
                  <div class="text-center">
                    <img class="img-fluid rounded shadow-sm hover-animate" src="/assets/ODS0080_es.jpg" style="max-width: 160px;" type="button"
                      data-bs-toggle="collapse" data-bs-target="#collapseExample8" aria-expanded="false"
                      aria-controls="collapseExample" data-ods="8" data-group="7_12">
                      <div class="result-container mt-2" id="result-Objetivo8"></div>
                  </div>
                  <div class="text-center mt-2">
                    <strong>Total de Variables ODS 8: 
                      <span id="contador-ods-8" class="text-primary" 
                        style="text-decoration: underline; font-size: 1.1rem; font-family: Monaco, monospace;">
                        0
                      </span>
                    </strong>
                  </div>
                </div>
          
                <div class="col-2"  id="Objetivo9">
                  <div class="text-center">
                    <img class="img-fluid rounded shadow-sm hover-animate" src="/assets/ODS0090_es.jpg" style="max-width: 160px;" type="button"
                      data-bs-toggle="collapse" data-bs-target="#collapseExample9" aria-expanded="false"
                      aria-controls="collapseExample" data-ods="9" data-group="7_12">
                      <div class="result-container mt-2" id="result-Objetivo9"></div>
                  </div>
                  <div class="text-center mt-2">
                    <strong>Total de Variables ODS 9: 
                      <span id="contador-ods-9" class="text-primary" 
                        style="text-decoration: underline; font-size: 1.1rem; font-family: Monaco, monospace;">
                        0
                      </span>
                    </strong>
                  </div>
                </div>
          
                <div class="col-2" id="Objetivo10">
                  <div class="text-center">
                    <img class="img-fluid rounded shadow-sm hover-animate" src="/assets/ODS0100_es.jpg" style="max-width: 160px;" type="button"
                      data-bs-toggle="collapse" data-bs-target="#collapseExample10" aria-expanded="false"
                      aria-controls="collapseExample" data-ods="10" data-group="7_12">
                      <div class="result-container mt-2" id="result-Objetivo10"></div>
                  </div>
                  <div class="text-center mt-2">
                    <strong>Total de Variables ODS 10: 
                      <span id="contador-ods-10" class="text-primary" 
                        style="text-decoration: underline; font-size: 1.1rem; font-family: Monaco, monospace;">
                        0
                      </span>
                    </strong>
                  </div>
                </div>
          
                <div class="col-2" id="Objetivo11">
                  <div class="text-center">
                    <img class="img-fluid rounded shadow-sm hover-animate" src="/assets/ODS0110_es.jpg" style="max-width: 160px;" type="button"
                      data-bs-toggle="collapse" data-bs-target="#collapseExample11" aria-expanded="false"
                      aria-controls="collapseExample" data-ods="11" data-group="7_12">
                      <div class="result-container mt-2" id="result-Objetivo11"></div>
                  </div>
                  <div class="text-center mt-2">
                    <strong>Total de Variables ODS 11: 
                      <span id="contador-ods-11" class="text-primary" 
                        style="text-decoration: underline; font-size: 1.1rem; font-family: Monaco, monospace;">
                        0
                      </span>
                    </strong>
                  </div>
                </div>
          
                <div class="col-2" id="Objetivo12">
                  <div class="text-center">
                    <img class="img-fluid rounded shadow-sm hover-animate" src="/assets/ODS0120_es.jpg" style="max-width: 160px;" type="button"
                      data-bs-toggle="collapse" data-bs-target="#collapseExample12" aria-expanded="false"
                      aria-controls="collapseExample" data-ods="12" data-group="7_12">
                      <div class="result-container mt-2" id="result-Objetivo12"></div>
                  </div>
                  <div class="text-center mt-2">
                    <strong>Total de Variables ODS 12: 
                      <span id="contador-ods-12" class="text-primary" 
                        style="text-decoration: underline; font-size: 1.1rem; font-family: Monaco, monospace;">
                        0
                      </span>
                    </strong>
                  </div>
                </div>
                <div class="col-lados-custom"></div>
          
              </div>

                <!-- Sección de variables relacionadas -->
               <!-- Contenedor dinámico para ODS 7 al 12 -->
            <div class="container mt-4 d-none" id="contenedorGrupo7_12">
              <div class="card shadow-sm border-0">
                <div class="card-body">
                  <div class="d-flex justify-content-end align-items-center mb-3">
                    <label for="itemsPerPage2" class="me-2 mb-0">Mostrar:</label>
                    <select id="itemsPerPage2" class="form-select w-auto">
                      <option value="10">10</option>
                      <option value="20">20</option>
                    </select>
                  </div>
                  <div id="chartArea7_12" class="d-flex justify-content-center my-4"></div>
                  <div id="OdsContainer7_12"></div>
                  <nav>
                    <ul class="pagination justify-content-center mt-4" id="pagination7_12"></ul>
                  </nav>
                </div>
              </div>
            </div>


<!-- Objetivos del 13 al 17 -->

              <div class="row g-1 mt-3">
                <div class="col-lados-custom"></div>
                <div class="col-2" id="Objetivo13">
                  <div class="text-center">
                    <img class="img-fluid rounded shadow-sm hover-animate" src="/assets/ODS0130_es.jpg" style="max-width: 160px;" type="button"
                      data-bs-toggle="collapse" data-bs-target="#collapseExample13" aria-expanded="false"
                      aria-controls="collapseExample" data-ods="13" data-group="13_17">
                      <div class="result-container mt-2" id="result-Objetivo13"></div>
                  </div>
                  <div class="text-center mt-2">
                    <strong>Total de Variables ODS 13: 
                      <span id="contador-ods-13" class="text-primary" 
                        style="text-decoration: underline; font-size: 1.1rem; font-family: Monaco, monospace;">
                        0
                      </span>
                    </strong>
                  </div>
                </div>
                <div class="col-2" id="Objetivo14">
                  <div class="text-center">
                    <img class="img-fluid rounded shadow-sm hover-animate" src="/assets/ODS0140_es.jpg" style="max-width: 160px;" type="button"
                      data-bs-toggle="collapse" data-bs-target="#collapseExample14" aria-expanded="false"
                      aria-controls="collapseExample"  data-ods="14" data-group="13_17">
                      <div class="result-container mt-2" id="result-Objetivo14"></div>
                  </div>
                  <div class="text-center mt-2">
                    <strong>Total de Variables ODS 14: 
                      <span id="contador-ods-14" class="text-primary" 
                        style="text-decoration: underline; font-size: 1.1rem; font-family: Monaco, monospace;">
                        0
                      </span>
                    </strong>
                  </div>
                </div>
                <div class="col-2" id="Objetivo15">
                  <div class="text-center">
                    <img class="img-fluid rounded shadow-sm hover-animate" src="/assets/ODS0150_es.jpg" style="max-width: 160px;" type="button"
                      data-bs-toggle="collapse" data-bs-target="#collapseExample15" aria-expanded="false"
                      aria-controls="collapseExample" data-ods="15" data-group="13_17">
                      <div class="result-container mt-2" id="result-Objetivo15"></div>
                  </div>
                  <div class="text-center mt-2">
                    <strong>Total de Variables ODS 15: 
                      <span id="contador-ods-15" class="text-primary" 
                        style="text-decoration: underline; font-size: 1.1rem; font-family: Monaco, monospace;">
                        0
                      </span>
                    </strong>
                  </div>
                </div>
                <div class="col-2" id="Objetivo16">
                  <div class="text-center">
                    <img class="img-fluid rounded shadow-sm hover-animate" src="/assets/ODS0160_es.jpg" style="max-width: 160px;" type="button"
                      data-bs-toggle="collapse" data-bs-target="#collapseExample16" aria-expanded="false"
                      aria-controls="collapseExample" data-ods="16" data-group="13_17">
                      <div class="result-container mt-2" id="result-Objetivo16"></div>
                  </div>
                  <div class="text-center mt-2">
                    <strong>Total de Variables ODS 16: 
                      <span id="contador-ods-16" class="text-primary" 
                        style="text-decoration: underline; font-size: 1.1rem; font-family: Monaco, monospace;">
                        0
                      </span>
                    </strong>
                  </div>
                </div>
                <div class="col-2" id="Objetivo17">
                  <div class="text-center">
                    <img class="img-fluid rounded shadow-sm hover-animate" src="/assets/ODS0170_es.jpg" style="max-width: 160px;" type="button"
                      data-bs-toggle="collapse" data-bs-target="#collapseExample17" aria-expanded="false"
                      aria-controls="collapseExample" data-ods="17" data-group="13_17">
                      <div class="result-container mt-2" id="result-Objetivo17"></div>
                  </div>
                  <div class="text-center mt-2">
                    <strong>Total de Variables ODS 17: 
                      <span id="contador-ods-17" class="text-primary" 
                        style="text-decoration: underline; font-size: 1.1rem; font-family: Monaco, monospace;">
                      </span>
                    </strong>
                  </div>
                </div>
                <div class="col-2">
                  <div class="text-center">
                    <img class="img-fluid rounded shadow-sm hover-animate" src="/assets/ODSLOG.jpg" style="max-width: 161px;" type="button">
                  </div>
          
                </div>
                <div class="col-lados-custom"></div>
              </div>

                <!-- Sección de variables relacionadas -->
                <!-- Contenedor dinámico para ODS 13 al 17 -->
                <div class="container mt-4 d-none" id="contenedorGrupo13_17">
                  <div class="card shadow-sm border-0">
                    <div class="card-body">
                      <div class="d-flex justify-content-end align-items-center mb-3">
                        <label for="itemsPerPage3" class="me-2 mb-0">Mostrar:</label>
                        <select id="itemsPerPage3" class="form-select w-auto">
                          <option value="10">10</option>
                          <option value="20">20</option>
                        </select>
                      </div>
                      <div id="chartArea13_17" class="d-flex justify-content-center my-4"></div>
                      <div id="OdsContainer13_17"></div>
                      <nav>
                        <ul class="pagination justify-content-center mt-4" id="pagination13_17"></ul>
                      </nav>
                    </div>
                  </div>
                </div>
        </div>
  </div>

<script>

  document.addEventListener("DOMContentLoaded", function () {
      // Activar link activo
      const currentPath = window.location.pathname.split("/").pop();
      const navLinks = document.querySelectorAll(".navbar-nav .nav-link");
      navLinks.forEach(link => {
        const href = link.getAttribute("href");
        if (href === currentPath) link.classList.add("active");
      });

      // Variables globales
      let data = [];
      let filteredData = {};
      let itemsPerPage = 10;
      let currentPage = 1;

      // Función para contar metas por ODS
      function contarMetasEspecificasPorODS(data) {
      const contador = {};

      data.forEach(variable => {
        const metaCompleta = variable.meta; 

        if (metaCompleta && metaCompleta.startsWith("Meta_")) {
          const meta = metaCompleta.replace("Meta_", ""); 
          const [ods] = meta.split("."); 

          if (!contador[ods]) contador[ods] = {};
          if (!contador[ods][meta]) contador[ods][meta] = 0;

          contador[ods][meta]++;
        }
      });

      return contador;
    }


      function updateVariableCounter(metaNumber, count) {
        const counterElement = document.getElementById(`contador-ods-${metaNumber}`);
        if (counterElement) counterElement.textContent = count;
      }

      function renderItems(items, container, paginationContainer, metaNumber) {
        container.innerHTML = "";
        paginationContainer.innerHTML = "";
        const totalPages = Math.ceil(items.length / itemsPerPage);

        function renderPage(page) {
          container.innerHTML = "";
          const start = (page - 1) * itemsPerPage;
          const end = start + itemsPerPage;
          const pageItems = items.slice(start, end);

          updateVariableCounter(metaNumber, items.length);

          pageItems.forEach(item => {
            const card = document.createElement("div");
            card.classList.add("col-12", "mb-3");
            card.innerHTML = `
              <div class="card shadow-sm border-0 rounded-4">
                <div class="card-body">
                  <h5 class="card-title fw-bold text-primary mb-3">${item.varAsig}</h5>
                  <p class="card-text mb-2">
                    <span class="fw-semibold text-success">ODS:</span> ${item.ods.replace(/_/g, ' ')}
                  </p>
                  <p class="card-text mb-3">
                    <span class="fw-semibold text-secondary">Meta ODS detectada:</span> ${item.meta.replace(/_/g, ' ')}
                  </p>
                  <h6 class="text-uppercase text-muted small mb-2">Clasificación Temática</h6>
                  <ul class="list-unstyled ps-3">
                    <li class="mb-1"><i class="bi bi-check-circle text-success me-1"></i><strong>Indicador ODS:</strong> ${item.indicador.replace(/_/g, ' ')}</li>
                    <li class="mb-1"><i class="bi bi-graph-up-arrow text-warning me-1"></i><strong>Nivel de Contribución:</strong> ${item.nivContOdss}</li>
                    <li class="mb-1"><i class="bi bi-chat-left-text text-info me-1"></i><strong>Comentario:</strong> ${item.comentOds}</li>
                  </ul>
                </div>
              </div>`;
            container.appendChild(card);
          });
        }

        function renderPagination() {
          paginationContainer.innerHTML = "";
          const maxPagesToShow = 10;
          let startPage = Math.max(1, currentPage - Math.floor(maxPagesToShow / 2));
          let endPage = startPage + maxPagesToShow - 1;

          if (endPage > totalPages) {
            endPage = totalPages;
            startPage = Math.max(1, endPage - maxPagesToShow + 1);
          }

          // Botón de página 1 y puntos suspensivos al inicio
          if (startPage > 1) {
            addPageButton(1);
            if (startPage > 2) addEllipsis();
          }

          // Botones de páginas visibles
          for (let i = startPage; i <= endPage; i++) {
            addPageButton(i);
          }

          // Puntos suspensivos y botón de última página
          if (endPage < totalPages) {
            if (endPage < totalPages - 1) addEllipsis();
            addPageButton(totalPages);
          }

          function addPageButton(page) {
            const li = document.createElement("li");
            li.classList.add("page-item");
            if (page === currentPage) li.classList.add("active");
            const a = document.createElement("a");
            a.classList.add("page-link");
            a.href = "#";
            a.textContent = page;
            a.addEventListener("click", e => {
              e.preventDefault();
              currentPage = page;
              renderPage(currentPage);
              renderPagination();
            });
            li.appendChild(a);
            paginationContainer.appendChild(li);
          }

          function addEllipsis() {
            const li = document.createElement("li");
            li.classList.add("page-item", "disabled");
            const span = document.createElement("span");
            span.classList.add("page-link");
            span.textContent = "...";
            li.appendChild(span);
            paginationContainer.appendChild(li);
          }
        }

        renderPage(currentPage);
        if (totalPages > 1) renderPagination();
        }
      

      // Fetch data y mostrar contadores
      fetch("/api/ods")
        .then(response => response.json())
        .then(responseData => {
          data = responseData;

          // Agrupar por número de meta
          filteredData = data.reduce((acc, item) => {
            const metaNumber = item.meta.match(/\d+/)?.[0];
            if (metaNumber) {
              if (!acc[metaNumber]) acc[metaNumber] = [];
              acc[metaNumber].push(item);
            }
            return acc;
          }, {});

          // Mostrar contador total por meta
          for (const meta in filteredData) {
            const count = filteredData[meta].length;
            const counterElement = document.getElementById(`contador-ods-${meta}`);
            if (counterElement) counterElement.textContent = count;
          }

          // Mostrar metas específicas
          const metasPorODS = contarMetasEspecificasPorODS(data);
          console.log("Metas por ODS:", metasPorODS);
          for (const ods in metasPorODS) {
            const metaObj = metasPorODS[ods];
            const container = document.getElementById(`result-Objetivo${ods}`);
            if (container) {
              container.innerHTML = "<h6 class='fw-bold text-muted mb-2'>Metas ODS detectadas:</h6><ul class='list-unstyled'>";
              for (const meta in metaObj) {
                container.innerHTML += `
                  <li class="mb-1">
                    <i class="bi bi-check-circle-fill text-success me-1"></i>
                    <strong>${meta}:</strong> ${metaObj[meta]} variable(s)
                  </li>`;
              }
              container.innerHTML += "</ul>";
            }

            // Crear nuevo canvas
            const canvas = document.createElement("canvas");
            canvas.id = `grafico-ods-${ods}`;
            canvas.style.maxHeight = "500px";
            canvas.style.maxWidth = "800px";
            canvas.style.width = "100%";
            canvas.style.display = "none"; // Oculto por defecto

            // Determinar el área de gráfico según el grupo
            let chartAreaId = "";
            if (ods >= 1 && ods <= 6) chartAreaId = "chartArea1_6";
            else if (ods >= 7 && ods <= 12) chartAreaId = "chartArea7_12";
            else if (ods >= 13 && ods <= 17) chartAreaId = "chartArea13_17";

            if (chartAreaId) {
              const chartArea = document.getElementById(chartAreaId);
              if (chartArea) {
                chartArea.appendChild(canvas);
              }
            }

            // Definir colores únicos por ODS (puedes ajustar)
            const colorBase = {
              "1": "rgba(255, 99, 132, 0.7)",
              "2": "rgba(255, 159, 64, 0.7)",
              "3": "rgba(255, 205, 86, 0.7)",
              "4": "rgba(75, 192, 192, 0.7)",
              "5": "rgba(54, 162, 235, 0.7)",
              "6": "rgba(153, 102, 255, 0.7)",
              "7": "rgba(201, 203, 207, 0.7)",
              "8": "rgba(100, 181, 246, 0.7)",
              "9": "rgba(255, 112, 67, 0.7)",
              "10": "rgba(124, 179, 66, 0.7)",
              "11": "rgba(0, 172, 193, 0.7)",
              "12": "rgba(255, 238, 88, 0.7)",
              "13": "rgba(67, 160, 71, 0.7)",
              "14": "rgba(41, 182, 246, 0.7)",
              "15": "rgba(139, 195, 74, 0.7)",
              "16": "rgba(121, 85, 72, 0.7)",
              "17": "rgba(156, 39, 176, 0.7)"
            };

            const color = colorBase[ods] || "rgba(229, 35, 61, 0.7)";

            // Crear gráfico
            new Chart(canvas, {
              type: "bar",
              data: {
                labels: Object.keys(metaObj).map(meta => `Meta ${meta}`),
                datasets: [{
                  label: "Variables por Meta",
                  data: Object.values(metaObj),
                  backgroundColor: color,
                  borderColor: color.replace("0.7", "1"),
                  borderWidth: 1,
                }]
              },
              options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                  x: {
                    ticks: {
                      autoSkip: false,
                      maxRotation: 45,
                      minRotation: 0
                    }
                  },
                  y: {
                    beginAtZero: true,
                    title: {
                      display: true,
                      text: "Número de variables"
                    }
                  }
                },
                plugins: {
                  legend: {
                    display: false
                  },
                  tooltip: {
                    callbacks: {
                      label: context => `${context.parsed.y} variable(s)`
                    }
                  }
                }
              }
            });

          }
        })
        
        .catch(error => console.error("Error al obtener los datos de la API:", error));

      // Eventos de clic en imágenes
      document.querySelectorAll("img[data-ods]").forEach(img => {
        img.addEventListener("click", function () {
          const ods = this.getAttribute("data-ods");
          const group = this.getAttribute("data-group");
          const contenedorId = `contenedorGrupo${group}`;
          const container = document.getElementById(`OdsContainer${group}`);
          const paginationContainer = document.getElementById(`pagination${group}`);

          document.querySelectorAll('[id^="contenedorGrupo"]').forEach(div => div.classList.add('d-none'));

          const contenedor = document.getElementById(contenedorId);
          const grafico = document.getElementById(`grafico-ods-${ods}`);

          if (contenedor.dataset.meta === ods) {
            container.innerHTML = "";
            paginationContainer.innerHTML = "";
            contenedor.classList.add("d-none");
            delete contenedor.dataset.meta;
            // Oculta el gráfico también
            if (grafico) grafico.style.display = "none";
            return;
          }

          if (contenedor) {
            contenedor.classList.remove("d-none");
            contenedor.dataset.meta = ods;
            if (filteredData[ods]) {
              renderItems(filteredData[ods], container, paginationContainer, ods);
              contenedor.scrollIntoView({ behavior: "smooth" });
            } else {
              container.innerHTML = "<p class='text-center'>No hay datos disponibles para este objetivo.</p>";
              paginationContainer.innerHTML = "";
            }
          }
          // Oculta todos los gráficos
          document.querySelectorAll("canvas[id^='grafico-ods-']").forEach(c => c.style.display = "none");
          // Muestra solo el gráfico correspondiente en el área de cards
          if (grafico) grafico.style.display = "block";
        });
      });

      // Cambio de cantidad por página
      document.getElementById("itemsPerPage").addEventListener("change", function () {
        itemsPerPage = parseInt(this.value, 10);
        currentPage = 1;
        const visibleContainer = [...document.querySelectorAll('[id^="contenedorGrupo"]')]
          .find(div => !div.classList.contains("d-none"));

        if (visibleContainer) {
          const group = visibleContainer.id.replace("contenedorGrupo", "");
          const container = document.getElementById(`OdsContainer${group}`);
          const paginationContainer = document.getElementById(`pagination${group}`);
          const targetMeta = visibleContainer.dataset.meta;

          if (targetMeta && filteredData[targetMeta]) {
            renderItems(filteredData[targetMeta], container, paginationContainer, targetMeta);
          }
        }
      });

    });

</script>

 <!--! FOOTER -->
    <div class="container-fluid" style="background-color: #5d5d5d">
       <footer class="bd-footer">
         <div class="pt-4 pb-4">
           <div class="container">
             <div class="row">
               <div class="col-lg">
     
                 <a style="color: white; font-weight: bold; font-size: 15px; font-family: Helvetica, Sans-Serif; ">Contacto</a>
                 <ul class="nav flex-column">
                   <li><a href="https://www.inegi.org.mx/"><img class="img-fluid d-block m-1" style="height: 2.5rem; width: 12rem;" src="/assets/INEGI_c-modified.png"></a></li>
                   <li class="nav-item mb-2"><a href="#" class="nav-link p-0 text" style="color: white"></a>
                   </li>
                   <li><a class="text-white d-block pt-1" href="https://www.inegi.org.mx/inegi/contacto.html#Directorios" style="font-family: Helvetica, Sans-Serif;">Directorio</a></li>
                   <li><a class="text-white d-block pt-1" href="https://www.inegi.org.mx/inegi/contacto.html" style="font-family: Helvetica, Sans-Serif;">Solicitud de información</a></li>
                   <br>
                   <ul style="list-style: none; padding: 0; display: flex; gap: 10px; margin-bottom: 5px;">
                   <li><a href="http://www.facebook.com/pages/inegi-informa/180299958681029" style="color: white"><i class="bi bi-facebook"></i></a></li>
                   <li><a href="http://twitter.com/inegi_informa" style="color: white"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="currentColor" class="bi bi-twitter-x" viewBox="0 0 16 16">
                     <path d="M12.6.75h2.454l-5.36 6.142L16 15.25h-4.937l-3.867-5.07-4.425 5.07H.316l5.733-6.57L0 .75h5.063l3.495 4.633L12.601.75Zm-.86 13.028h1.36L4.323 2.145H2.865z"/>
                   </svg></a></li>
                   <li><a href="https://www.youtube.com/user/INEGIInforma" style="color: white"><i class="bi bi-youtube"></i></a></li>
                   <li><a href="https://www.instagram.com/inegi_informa/" style="color: white;"><i class="bi bi-instagram"></i></a></li>
                   <li><a href="https://www.inegi.org.mx/servicios/rss/" style="color: white"><i class="bi bi-rss-fill"></i></a></li>
                   </ul>
                 </ul>
               </div>
               <div class="col-lg">
                 <a style="color: white; font-weight: bold; font-size: 15px">Sitios de interés</a>
                 <ul class="nav flex-column">
                   <li class="nav-item mb-2"><a href="https://www.snieg.mx/cni/" target="_blank" class="nav-link p-0 text"
                       style="color: white; font-size: 14px; font-family: Helvetica, Sans-Serif;">Catálogo Nacional de Indicadores</a></li>
                   <li class="nav-item mb-2"><a href="https://www.cepal.org/es" target="_blank"
                       class="nav-link p-0 text" style="color: white; font-size: 14px ; font-family: Helvetica, Sans-Serif;">CEPAL</a></li>
                   <li class="nav-item mb-2"><a href="https://www.un.org/sustainabledevelopment/es/objetivos-de-desarrollo-sostenible/" target="_blank" class="nav-link p-0 text"
                         style="color: white; font-size: 14px ; font-family: Helvetica, Sans-Serif;">ODS-ONU</a></li>
                   <li class="nav-item mb-2"><a href="http://agenda2030.mx/" target="_blank" class="nav-link p-0 text"
                       style="color: white; font-size: 14px ; font-family: Helvetica, Sans-Serif;">SIODS</a></li>
                   <li class="nav-item mb-2"><a href="https://www.gob.mx/semarnat/acciones-y-programas/sistema-nacional-de-informacion-ambiental-y-de-recursos-naturales" target="_blank" class="nav-link p-0 text"
                       style="color: white; font-size: 14px ; font-family: Helvetica, Sans-Serif;">SNIARN</a></li>
                   <li class="nav-item mb-2"><a href="#" [routerLink]="['/dg/new']" target="_blank"
                     class="nav-link p-0 text" style="color: white; font-size: 14px ; font-family: Helvetica, Sans-Serif;">Ver más...</a></li>
                 </ul>
               </div>
             </div>
           </div>
         </div>
       </footer>
     </div>
     
   <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>   


<!-- Botón flotante de scroll -->
<button id="scrollBtn" type="button" class="btn btn-primary rounded-circle shadow"
  style="position: fixed; bottom: 30px; right: 30px; z-index: 9999; width: 56px; height: 56px; display: none;">
  <i id="scrollBtnIcon" class="bi bi-arrow-down"></i>
</button>

<script>
document.addEventListener("DOMContentLoaded", function () {
  const scrollBtn = document.getElementById("scrollBtn");
  const scrollBtnIcon = document.getElementById("scrollBtnIcon");

  // Mostrar/ocultar botón y cambiar icono según posición
  window.addEventListener("scroll", function () {
    if (window.scrollY > 100 && (window.innerHeight + window.scrollY) < document.body.offsetHeight - 100) {
      scrollBtn.style.display = "block";
      scrollBtnIcon.className = "bi bi-arrow-down";
      scrollBtn.setAttribute("data-direction", "down");
    } else if ((window.innerHeight + window.scrollY) >= document.body.offsetHeight - 100) {
      scrollBtn.style.display = "block";
      scrollBtnIcon.className = "bi bi-arrow-up";
      scrollBtn.setAttribute("data-direction", "up");
    } else {
      scrollBtn.style.display = "none";
    }
  });

  // Acción del botón
  scrollBtn.addEventListener("click", function () {
    if (scrollBtn.getAttribute("data-direction") === "down") {
      window.scrollTo({ top: document.body.scrollHeight, behavior: "smooth" });
    } else {
      window.scrollTo({ top: 0, behavior: "smooth" });
    }
  });
});
</script>
</body>
</html>
